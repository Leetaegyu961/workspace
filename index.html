<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>로또 번호 추천기</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1a33;
      --text:#e8eefc;
      --muted:#aab6d6;
      --line:rgba(255,255,255,.12);
      --accent:#7c9dff;
      --accent2:#38d6b3;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
      --radius: 18px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff;
        --card:#ffffff;
        --text:#0b1220;
        --muted:#4b587a;
        --line:rgba(11,18,32,.12);
        --accent:#3b5cff;
        --accent2:#0ea27f;
        --shadow: 0 18px 60px rgba(20,30,60,.12);
      }
    }
    :root[data-theme="light"]{
      --bg:#f6f8ff;
      --card:#ffffff;
      --text:#0b1220;
      --muted:#4b587a;
      --line:rgba(11,18,32,.12);
      --accent:#3b5cff;
      --accent2:#0ea27f;
      --shadow: 0 18px 60px rgba(20,30,60,.12);
    }
    :root[data-theme="dark"]{
      --bg:#0b1220;
      --card:#0f1a33;
      --text:#e8eefc;
      --muted:#aab6d6;
      --line:rgba(255,255,255,.12);
      --accent:#7c9dff;
      --accent2:#38d6b3;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", AppleSDGothicNeo, "Malgun Gothic", sans-serif;
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(124,157,255,.25), transparent 60%),
        radial-gradient(800px 450px at 85% 20%, rgba(56,214,179,.18), transparent 55%),
        var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    .wrap{max-width:820px;margin:0 auto;padding:28px 18px 52px}
    header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
      padding:8px 2px 18px;
    }
    .brand{display:flex;align-items:center;gap:10px}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: var(--shadow);
      position:relative; overflow:hidden;
    }
    .logo:after{
      content:""; position:absolute; inset:-35%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.55), transparent 55%);
      transform: rotate(15deg);
    }
    h1{font-size:16px;margin:0}
    .sub{margin:0;color:var(--muted);font-size:12px}
    .card{
      background: rgba(255,255,255,.05);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .top{
      padding:18px 18px 14px;
      border-bottom:1px solid var(--line);
      background: rgba(255,255,255,.04);
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
    }
    .top h2{margin:0;font-size:14px;color:var(--muted);letter-spacing:.02em;text-transform:uppercase}
    .controls{display:flex;gap:10px;flex-wrap:wrap}
    .theme-toggle{display:flex;gap:6px;align-items:center}
    .theme-btn{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:8px 10px;
      border-radius:10px;
      font-size:12px;
      letter-spacing:.02em;
      text-transform:uppercase;
    }
    .theme-btn[data-active="true"]{
      border:0;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color:#071021;
      font-weight:800;
    }
    button{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      display:inline-flex;align-items:center;gap:8px;
      transition: transform .08s ease, background .15s ease, opacity .15s ease;
      user-select:none;
    }
    button:hover{transform: translateY(-1px); background:rgba(255,255,255,.10)}
    button.primary{
      border:0;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color:#071021;
      font-weight:800;
    }
    button:disabled{opacity:.55; cursor:not-allowed; transform:none}
    .body{padding:18px}
    .balls{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      min-height:58px;
    }
    .ball{
      width:54px;height:54px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      font-weight:900;
      font-size:18px;
      box-shadow: 0 10px 22px rgba(0,0,0,.18);
      transform: translateY(6px) scale(.98);
      opacity:0;
      animation: pop .35s ease forwards;
    }
    @keyframes pop{
      to{transform: translateY(0) scale(1); opacity:1}
    }
    .meta{
      margin-top:12px;
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;
      color:var(--muted); font-size:12px;
    }
    .history{
      margin-top:14px;
      border-top:1px solid var(--line);
      padding-top:14px;
    }
    .history h3{margin:0 0 10px;font-size:13px;color:var(--muted)}
    .hist-list{display:grid; gap:8px; margin:0; padding:0; list-style:none}
    .hist-item{
      display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      border-radius:14px;
      padding:10px 12px;
    }
    .hist-left{display:flex; gap:8px; flex-wrap:wrap}
    .mini{
      width:28px;height:28px;border-radius:999px;
      display:inline-flex;align-items:center;justify-content:center;
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      font-weight:800;
      font-size:12px;
    }
    .hist-time{color:var(--muted); font-size:12px}
    .note{color:var(--muted); font-size:12px; margin:0}
    footer{margin-top:16px;color:var(--muted);font-size:12px;padding:0 2px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>로또 번호 추천기</h1>
          <p class="sub">버튼 한 번에 6/45 랜덤 추천 (중복 없음)</p>
        </div>
      </div>
      <div class="theme-toggle" role="group" aria-label="테마 선택">
        <button class="theme-btn" id="themeDark" type="button" aria-pressed="false">다크</button>
        <button class="theme-btn" id="themeLight" type="button" aria-pressed="false">화이트</button>
      </div>
    </header>

    <section class="card" aria-label="로또 추천">
      <div class="top">
        <h2>추천 번호</h2>
        <div class="controls">
          <button class="primary" id="btnPick">번호 추천</button>
          <button id="btnPick5" title="5세트 한번에 생성">5세트</button>
          <button id="btnCopy" title="현재 추천 번호 복사" disabled>복사</button>
          <button id="btnReset" title="기록 초기화">초기화</button>
        </div>
      </div>

      <div class="body">
        <div class="balls" id="balls" aria-live="polite"></div>
        <div class="meta">
          <span id="status">아직 추천 없음</span>
          <span>범위: 1 ~ 45 · 6개</span>
        </div>

        <div class="history" id="historyBox" hidden>
          <h3>최근 추천 (최대 10개)</h3>
          <ul class="hist-list" id="histList"></ul>
          <p class="note">※ 당첨을 보장하지 않습니다. 그냥 재미로만!</p>
        </div>
      </div>
    </section>

    <footer>
      팁: “5세트”로 여러 장 살 때 한 번에 뽑고, 마음에 드는 세트만 복사해서 쓰면 편함.
    </footer>
  </div>

  <script>
    // ====== 로또 로직 ======
    const RANGE_MIN = 1;
    const RANGE_MAX = 45;
    const PICK_COUNT = 6;
    const HISTORY_LIMIT = 10;

    const $balls = document.getElementById('balls');
    const $status = document.getElementById('status');
    const $btnPick = document.getElementById('btnPick');
    const $btnPick5 = document.getElementById('btnPick5');
    const $btnCopy = document.getElementById('btnCopy');
    const $btnReset = document.getElementById('btnReset');
    const $historyBox = document.getElementById('historyBox');
    const $histList = document.getElementById('histList');
    const $themeDark = document.getElementById('themeDark');
    const $themeLight = document.getElementById('themeLight');

    let current = null;      // 현재 추천 번호 배열
    let history = [];        // { nums: number[], time: Date }
    let theme = null;        // 'dark' | 'light' | null

    function applyTheme(nextTheme){
      theme = nextTheme;
      if (theme === 'dark' || theme === 'light') {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
      } else {
        document.documentElement.removeAttribute('data-theme');
        localStorage.removeItem('theme');
      }
      syncThemeButtons();
    }

    function syncThemeButtons(){
      const isDark = theme === 'dark';
      const isLight = theme === 'light';
      $themeDark.dataset.active = isDark ? 'true' : 'false';
      $themeLight.dataset.active = isLight ? 'true' : 'false';
      $themeDark.setAttribute('aria-pressed', isDark ? 'true' : 'false');
      $themeLight.setAttribute('aria-pressed', isLight ? 'true' : 'false');
    }

    function randInt(min, max){
      // crypto가 있으면 더 좋은 난수 사용
      if (window.crypto && window.crypto.getRandomValues) {
        const arr = new Uint32Array(1);
        window.crypto.getRandomValues(arr);
        return min + (arr[0] % (max - min + 1));
      }
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function pickOneSet(){
      const set = new Set();
      while(set.size < PICK_COUNT){
        set.add(randInt(RANGE_MIN, RANGE_MAX));
      }
      return Array.from(set).sort((a,b)=>a-b);
    }

    function formatNums(nums){
      return nums.join(', ');
    }

    function renderBalls(nums){
      $balls.innerHTML = '';
      nums.forEach((n, i) => {
        const b = document.createElement('div');
        b.className = 'ball';
        b.style.animationDelay = (i * 60) + 'ms';
        b.textContent = n;
        $balls.appendChild(b);
      });
    }

    function addHistory(nums){
      history.unshift({ nums, time: new Date() });
      history = history.slice(0, HISTORY_LIMIT);
      renderHistory();
    }

    function renderHistory(){
      if(history.length === 0){
        $historyBox.hidden = true;
        $histList.innerHTML = '';
        return;
      }
      $historyBox.hidden = false;
      $histList.innerHTML = '';

      history.forEach((h) => {
        const li = document.createElement('li');
        li.className = 'hist-item';

        const left = document.createElement('div');
        left.className = 'hist-left';

        h.nums.forEach(n => {
          const m = document.createElement('span');
          m.className = 'mini';
          m.textContent = n;
          left.appendChild(m);
        });

        const right = document.createElement('div');
        right.className = 'hist-time';
        right.textContent = h.time.toLocaleString();

        li.appendChild(left);
        li.appendChild(right);

        // 클릭하면 그 세트가 현재 추천으로 올라오게
        li.style.cursor = 'pointer';
        li.title = '클릭해서 이 세트를 다시 선택';
        li.addEventListener('click', () => {
          current = h.nums.slice();
          renderBalls(current);
          $status.textContent = '선택됨: ' + formatNums(current);
          $btnCopy.disabled = false;
        });

        $histList.appendChild(li);
      });
    }

    function setBusy(isBusy){
      $btnPick.disabled = isBusy;
      $btnPick5.disabled = isBusy;
      $btnReset.disabled = isBusy;
      // 복사는 현재값이 없으면 원래 disabled 유지
      if (isBusy) $btnCopy.disabled = true;
      else $btnCopy.disabled = !current;
    }

    function doPickOne(){
      current = pickOneSet();
      renderBalls(current);
      addHistory(current);
      $status.textContent = '추천됨: ' + formatNums(current);
      $btnCopy.disabled = false;
    }

    async function doPickFive(){
      // 5세트는 기록에 5개 쌓이게 하고, 마지막 세트를 현재로 보여줌
      setBusy(true);
      $status.textContent = '5세트 생성 중...';

      for(let i=0; i<5; i++){
        const nums = pickOneSet();
        addHistory(nums);
        current = nums;
        renderBalls(current);
        $status.textContent = `(${i+1}/5) ${formatNums(current)}`;
        await new Promise(r => setTimeout(r, 220));
      }
      $status.textContent = '5세트 완료: ' + formatNums(current);
      setBusy(false);
    }

    async function copyCurrent(){
      if(!current) return;
      const text = formatNums(current);
      try{
        await navigator.clipboard.writeText(text);
        const prev = $btnCopy.textContent;
        $btnCopy.textContent = '복사됨';
        setTimeout(()=> $btnCopy.textContent = prev, 700);
      }catch(e){
        // clipboard 권한 실패 시 fallback
        prompt('복사가 막혀있어. 아래를 복사해:', text);
      }
    }

    function resetAll(){
      current = null;
      history = [];
      $balls.innerHTML = '';
      $status.textContent = '초기화됨';
      $btnCopy.disabled = true;
      renderHistory();
    }

    // ====== 이벤트 ======
    $btnPick.addEventListener('click', doPickOne);
    $btnPick5.addEventListener('click', doPickFive);
    $btnCopy.addEventListener('click', copyCurrent);
    $btnReset.addEventListener('click', resetAll);
    $themeDark.addEventListener('click', () => applyTheme('dark'));
    $themeLight.addEventListener('click', () => applyTheme('light'));

    (function initTheme(){
      const saved = localStorage.getItem('theme');
      if (saved === 'dark' || saved === 'light') {
        applyTheme(saved);
      } else {
        syncThemeButtons();
      }
    })();
  </script>
</body>
</html>
