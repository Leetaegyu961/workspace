<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>밤하늘 일정 기록</title>
  <meta name="description" content="오늘의 할 일을 별처럼 기록하고, 완료할수록 당신의 밤하늘이 채워지는 감성 일정 페이지" />
  <meta name="theme-color" content="#05060d" />
  <style>
    :root{
      --bg:#05060d;
      --bg2:#0c0f24;
      --card:rgba(14,20,44,.72);
      --text:#eef3ff;
      --muted:#9aa8d6;
      --line:rgba(255,255,255,.12);
      --accent:#7aa7ff;
      --accent2:#8ef4d5;
      --glow:0 0 28px rgba(122,167,255,.45);
      --radius:18px;
      --shadow:0 18px 60px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: "Pretendard", "Noto Sans KR", "Apple SD Gothic Neo", system-ui, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 500px at 10% 10%, rgba(122,167,255,.25), transparent 60%),
        radial-gradient(800px 500px at 90% 20%, rgba(142,244,213,.18), transparent 55%),
        radial-gradient(1200px 800px at 50% 120%, rgba(20,28,60,.9), transparent 70%),
        linear-gradient(180deg, #04050b, #0a0f22 70%, #0c122b);
      min-height:100vh;
    }
    .wrap{max-width:1080px;margin:0 auto;padding:28px 18px 60px}
    header{
      display:flex;justify-content:space-between;align-items:flex-end;gap:18px;flex-wrap:wrap;
      margin-bottom:18px;
    }
    h1{font-size:22px;margin:0 0 6px;letter-spacing:.02em}
    .sub{margin:0;color:var(--muted);font-size:13px;max-width:520px}
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .panel{padding:18px}
    .layout{display:grid;gap:16px;grid-template-columns: 360px 1fr}
    @media (max-width: 920px){
      .layout{grid-template-columns: 1fr}
    }
    label{display:grid;gap:6px;font-size:12px;color:var(--muted)}
    input, textarea, select{
      width:100%;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      font:inherit;
    }
    textarea{min-height:80px;resize:vertical}
    button{
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      display:inline-flex;align-items:center;gap:8px;
      transition: transform .08s ease, background .15s ease, opacity .15s ease;
      user-select:none;
    }
    button:hover{transform: translateY(-1px); background:rgba(255,255,255,.12)}
    button.primary{
      border:0;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color:#061022;
      font-weight:800;
    }
    .controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
    .meta{display:flex;gap:10px;flex-wrap:wrap;color:var(--muted);font-size:12px}
    .sky{
      position:relative;
      min-height:560px;
      border-radius:18px;
      border:1px solid var(--line);
      overflow:hidden;
      background:
        radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.5), transparent 60%),
        radial-gradient(2px 2px at 80% 20%, rgba(255,255,255,.35), transparent 60%),
        radial-gradient(1.5px 1.5px at 55% 60%, rgba(255,255,255,.45), transparent 60%),
        radial-gradient(1.5px 1.5px at 75% 75%, rgba(255,255,255,.4), transparent 60%),
        radial-gradient(1.5px 1.5px at 25% 70%, rgba(255,255,255,.4), transparent 60%),
        linear-gradient(180deg, #080a18, #0d1430 70%, #0b1230);
    }
    .sky::before{
      content:"";
      position:absolute;inset:0;
      background:
        radial-gradient(700px 380px at 10% 100%, rgba(122,167,255,.15), transparent 60%),
        radial-gradient(600px 320px at 100% 10%, rgba(142,244,213,.12), transparent 60%);
      pointer-events:none;
    }
    .star{
      position:absolute;
      width:10px;height:10px;
      border-radius:999px;
      background: radial-gradient(circle, #ffffff 0%, #c7d6ff 45%, rgba(122,167,255,.1) 70%, transparent 75%);
      box-shadow: 0 0 18px rgba(122,167,255,.55);
      transform: translate(-50%, -50%);
      opacity:.9;
      animation: twinkle 4s ease-in-out infinite;
    }
    .star[data-done="true"]{
      background: radial-gradient(circle, #bfffea 0%, #8ef4d5 50%, rgba(142,244,213,.2) 70%, transparent 78%);
      box-shadow: 0 0 22px rgba(142,244,213,.6);
    }
    .star[data-kind="업무"]{background: radial-gradient(circle, #ffe8c7 0%, #ffbf7a 55%, rgba(255,191,122,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(255,191,122,.55)}
    .star[data-kind="공부"]{background: radial-gradient(circle, #dbe8ff 0%, #8fb5ff 55%, rgba(143,181,255,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(143,181,255,.55)}
    .star[data-kind="운동"]{background: radial-gradient(circle, #ffd6e6 0%, #ff8bb5 55%, rgba(255,139,181,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(255,139,181,.55)}
    .star[data-kind="가족"]{background: radial-gradient(circle, #fff2c8 0%, #ffd986 55%, rgba(255,217,134,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(255,217,134,.55)}
    .star[data-kind="취미"]{background: radial-gradient(circle, #ebdcff 0%, #c29bff 55%, rgba(194,155,255,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(194,155,255,.55)}
    .star[data-kind="휴식"]{background: radial-gradient(circle, #d9fff2 0%, #7fe6c8 55%, rgba(127,230,200,.2) 75%, transparent 80%); box-shadow:0 0 22px rgba(127,230,200,.55)}
    @keyframes twinkle{0%,100%{opacity:.65}50%{opacity:1}}
    .star-label{
      position:absolute;
      transform: translate(-50%, calc(-50% - 18px));
      font-size:11px;
      color:var(--text);
      text-shadow: 0 0 8px rgba(0,0,0,.8);
      white-space:nowrap;
      opacity:.9;
    }
    .legend{
      display:flex;gap:12px;flex-wrap:wrap;
      font-size:12px;color:var(--muted);margin-top:10px
    }
    .dot{width:10px;height:10px;border-radius:999px;display:inline-block;margin-right:6px}
    .dot.todo{background:#c7d6ff;box-shadow:0 0 12px rgba(122,167,255,.4)}
    .dot.done{background:#8ef4d5;box-shadow:0 0 12px rgba(142,244,213,.4)}
    .list{margin:0;padding:0;list-style:none;display:grid;gap:10px}
    .item{
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;
      background:rgba(255,255,255,.04)
    }
    .item strong{display:block;font-size:13px}
    .item span{font-size:12px;color:var(--muted)}
    .badge{
      display:inline-flex;align-items:center;gap:6px;
      font-size:11px;color:var(--muted);
      border:1px solid var(--line);border-radius:999px;
      padding:4px 8px;background:rgba(255,255,255,.04)
    }
    footer{margin-top:18px;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>밤하늘 일정 기록</h1>
        <p class="sub">오늘의 할 일이 별이 되어 밤하늘에 남습니다. 완료한 순간, 그 별은 더 밝게 빛납니다.</p>
      </div>
      <div class="meta">
        <span class="badge">감성 기반 일정 기록</span>
        <span class="badge">로컬에서만 관리</span>
      </div>
    </header>

    <section class="layout">
      <div class="card panel" aria-label="일정 입력">
        <h2 style="margin:0 0 10px;font-size:16px">새 별 만들기</h2>
        <label>
          일정 제목
          <input type="text" id="title" placeholder="예: 엄마에게 안부 전화" />
        </label>
        <label>
          날짜
          <input type="date" id="date" />
        </label>
        <label>
          감정
          <select id="mood">
            <option value="따뜻함">따뜻함</option>
            <option value="설렘">설렘</option>
            <option value="차분함">차분함</option>
            <option value="결의">결의</option>
            <option value="그리움">그리움</option>
          </select>
        </label>
        <label>
          강도
          <select id="intensity">
            <option value="상">상</option>
            <option value="중" selected>중</option>
            <option value="하">하</option>
          </select>
        </label>
        <label>
          종류
          <select id="kind">
            <option value="업무">업무</option>
            <option value="공부">공부</option>
            <option value="운동">운동</option>
            <option value="가족">가족</option>
            <option value="취미">취미</option>
            <option value="휴식">휴식</option>
          </select>
        </label>
        <label>
          메모
          <textarea id="note" placeholder="이 일정이 왜 중요한지 한 줄 남겨보세요"></textarea>
        </label>
        <div class="controls">
          <button class="primary" id="add">별로 기록</button>
          <button id="clear">모두 지우기</button>
        </div>
        <p class="sub" style="margin-top:10px">각 일정은 하나의 별이 됩니다. 새 별은 중심에 추가되며, 드래그해 원하는 위치로 옮길 수 있습니다.</p>
        <p class="sub" style="margin-top:6px">별을 드래그해 나만의 별자리를 만들 수 있어요.</p>
        <div class="legend">
          <span><span class="dot todo"></span>진행 중</span>
          <span><span class="dot done"></span>완료</span>
        </div>
      </div>

      <div class="card panel" aria-label="별 지도">
        <h2 style="margin:0 0 10px;font-size:16px">오늘의 밤하늘</h2>
        <div class="sky" id="sky" role="img" aria-label="일정이 별로 표시되는 영역"></div>
        <div class="meta" style="margin-top:8px">
          <span id="count">총 0개의 별</span>
          <span id="done">완료 0개</span>
        </div>
      </div>
    </section>

    <section class="card panel" aria-label="일정 목록" style="margin-top:16px">
      <h2 style="margin:0 0 10px;font-size:16px">별 목록</h2>
      <ul class="list" id="list"></ul>
    </section>

    <footer>
      이 페이지는 로컬에서만 동작하며, 새로고침 시 기록이 초기화됩니다. (필요하면 저장 기능을 추가할 수 있어요.)
    </footer>
  </div>

  <script>
    const $title = document.getElementById('title');
    const $date = document.getElementById('date');
    const $mood = document.getElementById('mood');
    const $intensity = document.getElementById('intensity');
    const $kind = document.getElementById('kind');
    const $note = document.getElementById('note');
    const $add = document.getElementById('add');
    const $clear = document.getElementById('clear');
    const $sky = document.getElementById('sky');
    const $list = document.getElementById('list');
    const $count = document.getElementById('count');
    const $done = document.getElementById('done');

    const tasks = [];

    function rand(min, max){
      return Math.random() * (max - min) + min;
    }

    function clamp(val, min, max){
      return Math.max(min, Math.min(max, val));
    }

    function getSeedX(i){
      const angle = i * 0.85;
      const radius = Math.min(28 + i * 2.2, 42);
      return clamp(50 + Math.cos(angle) * radius, 8, 92);
    }

    function getSeedY(i){
      const angle = i * 0.85;
      const radius = Math.min(18 + i * 1.8, 36);
      return clamp(50 + Math.sin(angle) * radius, 10, 88);
    }

    function render(){
      $sky.innerHTML = '';
      $list.innerHTML = '';

      tasks.forEach((t, idx) => {
        const star = document.createElement('div');
        star.className = 'star';
        star.dataset.done = t.done ? 'true' : 'false';
        star.dataset.kind = t.kind;
        star.style.left = t.x + '%';
        star.style.top = t.y + '%';
        star.style.width = t.size + 'px';
        star.style.height = t.size + 'px';
        star.style.animationDelay = (idx * 0.4) + 's';

        const label = document.createElement('div');
        label.className = 'star-label';
        label.textContent = t.title;
        star.appendChild(label);

        star.title = t.title + ' / ' + t.date + ' / ' + t.mood + ' / ' + t.kind + ' / ' + t.intensity;
        star.dataset.idx = String(idx);
        star.addEventListener('click', () => toggleDone(idx));

        $sky.appendChild(star);

        const li = document.createElement('li');
        li.className = 'item';
        li.innerHTML = `
          <div>
            <strong>${t.title}</strong>
            <span>${t.date || '날짜 없음'} · ${t.mood} · ${t.kind} · ${t.intensity}</span>
            <div class="sub" style="margin-top:6px">${t.note || '메모 없음'}</div>
          </div>
          <div>
            <button data-idx="${idx}" class="toggle">${t.done ? '완료됨' : '완료 체크'}</button>
          </div>
        `;
        $list.appendChild(li);
      });

      const doneCount = tasks.filter(t => t.done).length;
      $count.textContent = `총 ${tasks.length}개의 별`;
      $done.textContent = `완료 ${doneCount}개`;
    }

    function addTask(){
      const title = $title.value.trim();
      if(!title){
        alert('일정 제목을 입력해 주세요.');
        return;
      }
      tasks.push({
        title,
        date: $date.value,
        mood: $mood.value,
        intensity: $intensity.value,
        kind: $kind.value,
        note: $note.value.trim(),
        done: false,
        x: getSeedX(tasks.length),
        y: getSeedY(tasks.length),
        size: $intensity.value === '상' ? 16 : ($intensity.value === '중' ? 12 : 8)
      });
      $title.value = '';
      $note.value = '';
      render();
    }

    function toggleDone(idx){
      tasks[idx].done = !tasks[idx].done;
      render();
    }

    function clearAll(){
      tasks.length = 0;
      render();
    }

    let dragging = null;

    function updateDrag(clientX, clientY){
      if(dragging === null) return;
      const rect = $sky.getBoundingClientRect();
      const x = ((clientX - rect.left) / rect.width) * 100;
      const y = ((clientY - rect.top) / rect.height) * 100;
      const t = tasks[dragging];
      if(!t) return;
      t.x = clamp(x, 4, 96);
      t.y = clamp(y, 6, 94);
      const star = $sky.querySelector(`.star[data-idx=\"${dragging}\"]`);
      if(star){
        star.style.left = t.x + '%';
        star.style.top = t.y + '%';
      }
    }

    $add.addEventListener('click', addTask);
    $clear.addEventListener('click', clearAll);
    $list.addEventListener('click', (e) => {
      const btn = e.target.closest('.toggle');
      if(!btn) return;
      toggleDone(Number(btn.dataset.idx));
    });
    $sky.addEventListener('pointerdown', (e) => {
      const star = e.target.closest('.star');
      if(!star) return;
      dragging = Number(star.dataset.idx);
      $sky.setPointerCapture(e.pointerId);
    });
    $sky.addEventListener('pointermove', (e) => {
      if(dragging === null) return;
      updateDrag(e.clientX, e.clientY);
    });
    $sky.addEventListener('pointerup', () => {
      dragging = null;
    });
    $sky.addEventListener('pointerleave', () => {
      dragging = null;
    });

    const today = new Date();
    $date.value = today.toISOString().slice(0,10);

    render();
  </script>
</body>
</html>
